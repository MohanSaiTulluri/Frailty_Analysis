import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

# Load the dataset
file_path = "frailty_data.xlsx"
df = pd.read_excel(/cleaned_data.xlsx)

# Data Cleaning
df.columns = df.columns.str.strip()  # Remove any trailing spaces
df['Frailty'] = df['Frailty'].map({'Y': 1, 'N': 0})  # Convert to numerical values

# Save cleaned data
df.to_csv("Data_Processed/cleaned_frailty_data.csv", index=False)

# Basic Statistics
summary_stats = df.describe()
print("Summary Statistics:\n", summary_stats)

# Correlation Matrix
correlation_matrix = df.corr()
plt.figure(figsize=(8, 6))
sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm', fmt='.2f')
plt.title("Correlation Matrix")
plt.savefig("Visualizations/correlation_matrix.png")
plt.show()

# Histogram of Grip Strength
plt.figure(figsize=(8, 5))
sns.histplot(df['Grip strength'], bins=10, kde=True)
plt.title("Distribution of Grip Strength")
plt.xlabel("Grip Strength (kg)")
plt.ylabel("Count")
plt.savefig("Visualizations/grip_distribution.png")
plt.show()

# Scatter Plot: Grip Strength vs. Age
plt.figure(figsize=(8, 5))
sns.scatterplot(x=df['Age'], y=df['Grip strength'], hue=df['Frailty'], palette={0: 'blue', 1: 'red'})
plt.title("Grip Strength vs. Age")
plt.xlabel("Age (years)")
plt.ylabel("Grip Strength (kg)")
plt.savefig("Visualizations/grip_vs_age.png")
plt.show()

# Boxplot: Grip Strength by Frailty
plt.figure(figsize=(8, 5))
sns.boxplot(x=df['Frailty'], y=df['Grip strength'])
plt.title("Grip Strength by Frailty Status")
plt.xlabel("Frailty (0=No, 1=Yes)")
plt.ylabel("Grip Strength (kg)")
plt.savefig("Visualizations/grip_vs_frailty.png")
plt.show()
